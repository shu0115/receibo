<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Ruby on Rails Guides: Asset Pipeline</title>

<link rel="stylesheet" type="text/css" href="stylesheets/style.css" />
<link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

<link rel="stylesheet" type="text/css" href="stylesheets/syntaxhighlighter/shCore.css" />
<link rel="stylesheet" type="text/css" href="stylesheets/syntaxhighlighter/shThemeRailsGuides.css" />

<link rel="stylesheet" type="text/css" href="stylesheets/fixes.css" />
</head>
<body class="guide">
  <div id="topNav">
    <div class="wrapper">
      <strong>More at <a href="http://rubyonrails.org/">rubyonrails.org:</a> </strong>
      <a href="http://rubyonrails.org/">Overview</a> |
      <a href="http://rubyonrails.org/download">Download</a> |
      <a href="http://rubyonrails.org/deploy">Deploy</a> |
      <a href="https://github.com/rails/rails">Code</a> |
      <a href="http://rubyonrails.org/screencasts">Screencasts</a> |
      <a href="http://rubyonrails.org/documentation">Documentation</a> |
      <a href="http://rubyonrails.org/ecosystem">Ecosystem</a> |
      <a href="http://rubyonrails.org/community">Community</a> |
      <a href="http://weblog.rubyonrails.org/">Blog</a>
    </div>
  </div>
  <div id="header">
    <div class="wrapper clearfix">
      <h1><a href="index.html" title="Return to home page">Guides.rubyonrails.org</a></h1>
      <p class="hide"><a href="#mainCol">Skip navigation</a>.</p>
      <ul class="nav">
        <li><a href="index.html">Home</a></li>
        <li class="index"><a href="index.html" onclick="guideMenu(); return false;" id="guidesMenu">Guides Index</a>
          <div id="guides" class="clearfix" style="display: none;">
            <hr />
            <dl class="L">
              <dt>Start Here</dt>
              <dd><a href="getting_started.html">Getting Started with Rails</a></dd>
              <dt>Models</dt>
              <dd><a href="migrations.html">Rails Database Migrations</a></dd>
              <dd><a href="active_record_validations_callbacks.html">Active Record Validations and Callbacks</a></dd>
              <dd><a href="association_basics.html">Active Record Associations</a></dd>
              <dd><a href="active_record_querying.html">Active Record Query Interface</a></dd>
              <dt>Views</dt>
              <dd><a href="layouts_and_rendering.html">Layouts and Rendering in Rails</a></dd>
              <dd><a href="form_helpers.html">Action View Form Helpers</a></dd>
              <dt>Controllers</dt>
              <dd><a href="action_controller_overview.html">Action Controller Overview</a></dd>
              <dd><a href="routing.html">Rails Routing from the Outside In</a></dd>
            </dl>
            <dl class="R">
              <dt>Digging Deeper</dt>
              <dd><a href="active_support_core_extensions.html">Active Support Core Extensions</a></dd>
              <dd><a href="i18n.html">Rails Internationalization API</a></dd>
              <dd><a href="action_mailer_basics.html">Action Mailer Basics</a></dd>
              <dd><a href="testing.html">Testing Rails Applications</a></dd>
              <dd><a href="security.html">Securing Rails Applications</a></dd>
              <dd><a href="debugging_rails_applications.html">Debugging Rails Applications</a></dd>
              <dd><a href="performance_testing.html">Performance Testing Rails Applications</a></dd>
              <dd><a href="configuring.html">Configuring Rails Applications</a></dd>
              <dd><a href="command_line.html">Rails Command Line Tools and Rake Tasks</a></dd>
              <dd><a href="caching_with_rails.html">Caching with Rails</a></dd>
              <dd><a href="asset_pipeline.html">Asset Pipeline</a></dd>

              <dt>Extending Rails</dt>
              <dd><a href="plugins.html">The Basics of Creating Rails Plugins</a></dd>
              <dd><a href="rails_on_rack.html">Rails on Rack</a></dd>
              <dd><a href="generators.html">Creating and Customizing Rails Generators</a></dd>

              <dt>Contributing to Ruby on Rails</dt>
              <dd><a href="contributing_to_ruby_on_rails.html">Contributing to Ruby on Rails</a></dd>
              <dd><a href="api_documentation_guidelines.html">API Documentation Guidelines</a></dd>
              <dd><a href="ruby_on_rails_guides_guidelines.html">Ruby on Rails Guides Guidelines</a></dd>

              <dt>Release Notes</dt>
              <dd><a href="3_1_release_notes.html">Ruby on Rails 3.1 Release Notes</a></dd>
              <dd><a href="3_0_release_notes.html">Ruby on Rails 3.0 Release Notes</a></dd>
              <dd><a href="2_3_release_notes.html">Ruby on Rails 2.3 Release Notes</a></dd>
              <dd><a href="2_2_release_notes.html">Ruby on Rails 2.2 Release Notes</a></dd>
            </dl>
          </div>
        </li>
        <li><a href="contributing_to_ruby_on_rails.html">Contribute</a></li>
        <li><a href="credits.html">Credits</a></li>
      </ul>
    </div>
  </div>
  <hr class="hide" />

  <div id="feature">
    <div class="wrapper">
      <h2>Asset Pipeline</h2>
<p>This guide covers the asset pipeline introduced in Rails 3.1.
By referring to this guide you will be able to:</p>
<ul>
	<li>Understand what the asset pipeline is and what it does</li>
	<li>Properly organize your application assets</li>
	<li>Understand the benefits of the asset pipeline</li>
	<li>Adding a pre-processor to the pipeline</li>
	<li>Package assets with a gem</li>
</ul>

            <div id="subCol">
        <h3 class="chapter"><img src="images/chapters_icon.gif" alt="" />Chapters</h3>
        <ol class="chapters">
<li><a href="#what-is-the-asset-pipeline">What is the Asset Pipeline?</a><ul><li><a href="#main-features">Main Features</a></li> <li><a href="#what-is-fingerprinting-and-why-should-i-care">What is Fingerprinting and Why Should I Care?</a></li></ul></li><li><a href="#how-to-use-the-asset-pipeline">How to Use the Asset Pipeline</a><ul><li><a href="#asset-organization">Asset Organization</a></li> <li><a href="#coding-links-to-assets">Coding Links to Assets</a></li> <li><a href="#manifest-files-and-directives">Manifest Files and Directives</a></li> <li><a href="#preprocessing">Preprocessing</a></li></ul></li><li><a href="#in-development">In Development</a><ul><li><a href="#turning-debugging-off">Turning Debugging off</a></li></ul></li><li><a href="#in-production">In Production</a><ul><li><a href="#precompiling-assets">Precompiling Assets</a></li> <li><a href="#live-compilation">Live Compilation</a></li></ul></li><li><a href="#customizing-the-pipeline">Customizing the Pipeline</a><ul><li><a href="#css-compression"><span class="caps">CSS</span> Compression</a></li> <li><a href="#javascript-compression">JavaScript Compression</a></li> <li><a href="#using-your-own-compressor">Using Your Own Compressor</a></li> <li><a href="#changing-the-_assets_-path">Changing the <em>assets</em> Path</a></li> <li><a href="#x-sendfile-headers">X-Sendfile Headers</a></li></ul></li><li><a href="#how-caching-works">How Caching Works</a></li><li><a href="#adding-assets-to-your-gems">Adding Assets to Your Gems</a></li><li><a href="#making-your-library-or-gem-a-pre-processor">Making Your Library or Gem a Pre-Processor</a></li><li><a href="#upgrading-from-old-versions-of-rails">Upgrading from Old Versions of Rails</a></li></ol></div>
    </div>
  </div>

  <div id="container">
    <div class="wrapper">
      <div id="mainCol">
        <h3 id="what-is-the-asset-pipeline">1 What is the Asset Pipeline?</h3>
<p>The asset pipeline provides a framework to concatenate and minify or compress JavaScript and <span class="caps">CSS</span> assets. It also adds the ability to write these assets in other languages such as CoffeeScript, Sass and <span class="caps">ERB</span>.</p>
<p>Prior to Rails 3.1 these features were added through third-party Ruby libraries such as Jammit and Sprockets. Rails 3.1 is integrated with Sprockets through Action Pack which depends on the <tt>sprockets</tt> gem, by default.</p>
<p>By having this as a core feature of Rails, all developers can benefit from the power of having their assets pre-processed, compressed and minified by one central library, Sprockets. This is part of Rails&#8217; &#8220;fast by default&#8221; strategy as outlined by <span class="caps">DHH</span> in his keynote at RailsConf 2011.</p>
<p>In Rails 3.1, the asset pipeline is enabled by default. It can be disabled in <tt>config/application.rb</tt> by putting this line inside the application class definition:</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
config.assets.enabled = false
</pre>
</div>
<p>You can also disable it while creating a new application by passing the <tt>&#8212;skip-sprockets</tt> option.</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
rails new appname --skip-sprockets
</pre>
</div>
<p>It is recommended that you use the defaults for all new apps.</p>
<h4 id="main-features">1.1 Main Features</h4>
<p>The first feature of the pipeline is to concatenate assets. This is important in a production environment, as it reduces the number of requests that a browser must make to render a web page.</p>
<p>While Rails already has a feature to concatenate these types of assets by placing <tt>:cache => true</tt> at the end of tags such as <tt>javascript_include_tag</tt> and <tt>stylesheet_link_tag</tt>, it has a series of limitations. For example, it cannot generate the caches in advance, and it is not able to transparently include assets provided by third-party libraries.</p>
<p>The default behavior in Rails 3.1 and onward is to concatenate all files into one master file each for JS and <span class="caps">CSS</span>. However, you can separate files or groups of files if required (see below). In production, an MD5 fingerprint is inserted into each filename so that the file is cached by the web browser but can be invalidated if the fingerprint is altered.</p>
<p>The second feature is to minify or compress assets. For <span class="caps">CSS</span>, this usually involves removing whitespace and comments. For JavaScript, more complex processes can be applied. You can choose from a set of built in options or specify your own.</p>
<p>The third feature is the ability to code these assets using another language, or language extension. These include Sass for <span class="caps">CSS</span>, CoffeeScript for JavaScript, and <span class="caps">ERB</span> for both.</p>
<h4 id="what-is-fingerprinting-and-why-should-i-care">1.2 What is Fingerprinting and Why Should I Care?</h4>
<p>Fingerprinting is a technique whereby the filenames of content that is static or infrequently updated are altered to be unique to the content contained in the file.</p>
<p>When a filename is unique and based on its content, <span class="caps">HTTP</span> headers can be set to encourage caches everywhere (at ISPs, in browsers) to keep their own copy of the content. When the content is updated, the fingerprint will change and the remote clients will request the new file. This is generally known as <em>cache busting</em>.</p>
<p>The most effective technique is to insert a hash of the content into the name, usually at the end. For example a <span class="caps">CSS</span> file <tt>global.css</tt> is hashed and the filename is updated to incorporate the digest, for example becoming:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
global-908e25f4bf641868d8683022a5b62f54.css
</pre>
</div>
<p>This is the strategy adopted by the Rails asset pipeline.</p>
<p>Rails&#8217; old strategy was to append a query string to every asset linked with a built-in helper. In the source the generated code looked like this:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
/stylesheets/global.css?1309495796
</pre>
</div>
<p>This has several disadvantages:</p>
<ol>
<li>
<strong>Not all caches will cache content with a query string</strong>.<br>
<a href="http://www.stevesouders.com/blog/2008/08/23/revving-filenames-dont-use-querystring/">Steve Souders recommends</a>, &#8220;&#8230;avoiding a querystring for cacheable resources&#8221;. He found that in this case 5-20% of requests will not be cached. Query strings in particular do not work at all with some CDNs for cache invalidation.
</li>
<li>
<strong>The file name can change between nodes in multi-server environments.</strong><br>
The query string in Rails is based on the modification time of the files. When assets are deployed to a cluster, there is no guarantee that the timestamps will be the same, resulting in different values being used depending on which server handles the request.
</li>
</ol>
<p>The other problem is that when static assets are deployed with each new release of code, the mtime of <em>all</em> these files changes, forcing all remote clients to fetch them again, even when the content of those assets has not changed.</p>
<p>Fingerprinting fixes these problems by avoiding query strings, and by ensuring filenames are consistent based on their content.</p>
<p>Fingerprinting is enabled by default for production and disabled for all the others environments. You can enable or disable it in your configuration through the <tt>config.assets.digest</tt> option.</p>
<p>More reading:</p>
<ul>
	<li><a href="http://code.google.com/speed/page-speed/docs/caching.html">Optimize caching</a></li>
	<li><a href="http://www.stevesouders.com/blog/2008/08/23/revving-filenames-dont-use-querystring/">Revving Filenames: don’t use querystring</a></li>
</ul>
<h3 id="how-to-use-the-asset-pipeline">2 How to Use the Asset Pipeline</h3>
<p>In previous versions of Rails, all assets were located in subdirectories of <tt>public</tt> such as <tt>images</tt>, <tt>javascripts</tt> and <tt>stylesheets</tt>. With the asset pipeline, the preferred location for these assets is now the <tt>app/assets</tt> directory. Files in this directory are served by the Sprockets middleware included in the sprockets gem.</p>
<p>This is not to say that assets can (or should) no longer be placed in <tt>public</tt>; they still can be and will be served as static files by the application or web server. You would only use <tt>app/assets</tt> if you wish your files to undergo some pre-processing before they are served.</p>
<p>In production, the default is to precompile these files to <tt>public/assets</tt> so that they can be more efficiently delivered by the web server.</p>
<p>When a scaffold or controller is generated for the application, Rails also generates a JavaScript file (or CoffeeScript file if the <tt>coffee-rails</tt> gem is in the <tt>Gemfile</tt>) and a Cascading Style Sheet file (or <span class="caps">SCSS</span> file if <tt>sass-rails</tt> is in the <tt>Gemfile</tt>) for that controller.</p>
<p>For example, if a <tt>ProjectsController</tt> is generated, there will be a new file at <tt>app/assets/javascripts/projects.js.coffee</tt> and another at <tt>app/assets/stylesheets/projects.css.scss</tt>. You should put any JavaScript or <span class="caps">CSS</span> unique to a controller inside their respective asset files, as these files can then be loaded just for these controllers with lines such as <tt><%= javascript_include_tag params[:controller] %></tt> or <tt><%= stylesheet_link_tag params[:controller] %></tt>.</p>
<div class="note"><p>You will need a <a href="https://github.com/sstephenson/execjs#readme">ExecJS</a> supported runtime in order to use CoffeeScript. If you are using Mac OS X or Windows you have a JavaScript runtime installed in your operating system. Check <a href="https://github.com/sstephenson/execjs#readme">ExecJS</a> documentation to know all supported JavaScript runtimes.</p></div>
<h4 id="asset-organization">2.1 Asset Organization</h4>
<p>Assets can be placed inside an application in one of three locations: <tt>app/assets</tt>, <tt>lib/assets</tt> or <tt>vendor/assets</tt>.</p>
<p><tt>app/assets</tt> is for assets that are owned by the application, such as custom images, JavaScript files or stylesheets.</p>
<p><tt>lib/assets</tt> is for your own libraries&#8217; code that doesn&#8217;t really fit into the scope of the application or those libraries which are shared across applications.</p>
<p><tt>vendor/assets</tt> is for assets that are owned by outside entities, such as code for JavaScript plugins.</p>
<p>All subdirectories that exist within these three locations are added to the search path for Sprockets (visible by calling <tt>Rails.application.config.assets.paths</tt> in a console). When an asset is requested, these paths are traversed to see if they contain an asset matching the name specified. Once an asset has been found, it&#8217;s processed by Sprockets and served.</p>
<p>You can add additional (fully qualified) paths to the pipeline in <tt>config/application.rb</tt>. For example:</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
config.assets.paths &lt;&lt; Rails.root.join(&quot;app&quot;, &quot;assets&quot;, &quot;flash&quot;)
</pre>
</div>
<h4 id="coding-links-to-assets">2.2 Coding Links to Assets</h4>
<p>Sprockets does not add any new methods to access your assets &#8211; you still use the familiar <tt>javascript_include_tag</tt> and <tt>stylesheet_link_tag</tt>.</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
&lt;%= stylesheet_link_tag &quot;application&quot; %&gt;
&lt;%= javascript_include_tag &quot;application&quot; %&gt;
</pre>
</div>
<p>In regular views you can access images in the <tt>assets/images</tt> directory like this:</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
&lt;%= image_tag &quot;rails.png&quot; %&gt;
</pre>
</div>
<p>Provided that the pipeline is enabled within your application (and not disabled in the current environment context), this file is served by Sprockets. If a file exists at <tt>public/assets/rails.png</tt> it is served by the webserver.</p>
<p>Alternatively, a request for a file with an MD5 hash such as <tt>public/assets/rails-af27b6a414e6da00003503148be9b409.png</tt> is treated the same way. How these hashes are generated is covered in the <a href="#in-production">In Production</a> section later on in this guide.</p>
<p>Sprockets will also look through the paths specified in <tt>config.assets.paths</tt> which includes the standard application paths and any path added by Rails engines.</p>
<p>Images can also be organized into subdirectories if required, and they can be accessed by specifying the directory&#8217;s name in the tag:</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
&lt;%= image_tag &quot;icons/rails.png&quot; %&gt;
</pre>
</div>
<h5 id="css-and-erb">2.2.1 <span class="caps">CSS</span> and <span class="caps">ERB</span></h5>
<p>If you add an <tt>erb</tt> extension to a <span class="caps">CSS</span> asset, making it something such as <tt>application.css.erb</tt>, then helpers like <tt>asset_path</tt> are available in your <span class="caps">CSS</span> rules:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
.class { background-image: url(&lt;%= asset_path 'image.png' %&gt;) }
</pre>
</div>
<p>This writes the path to the particular asset being referenced. In this example, it would make sense to have an image in one of the asset load paths, such as <tt>app/assets/images/image.png</tt>, which would be referenced here. If this image is already available in <tt>public/assets</tt> as a fingerprinted file, then that path is referenced.</p>
<p>If you want to use a <a href="http://en.wikipedia.org/wiki/Data_URI_scheme">data <span class="caps">URI</span></a> &#8212; a method of embedding the image data directly into the <span class="caps">CSS</span> file &#8212; you can use the <tt>asset_data_uri</tt> helper.</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
#logo { background: url(&lt;%= asset_data_uri 'logo.png' %&gt;) }
</pre>
</div>
<p>This inserts a correctly-formatted data <span class="caps">URI</span> into the <span class="caps">CSS</span> source.</p>
<p>Note that the closing tag cannot be of the style <tt>-%></tt>.</p>
<h5 id="css-and-sass">2.2.2 <span class="caps">CSS</span> and Sass</h5>
<p>When using the asset pipeline, paths to assets must be re-written and <tt>sass-rails</tt> provides <tt>-url</tt> and <tt>-path</tt> helpers (hyphenated in Sass, underscored in Ruby) for the following asset classes: image, font, video, audio, JavaScript and stylesheet.</p>
<ul>
	<li><tt>image-url("rails.png")</tt> becomes <tt>url(/assets/rails.png)</tt></li>
	<li><tt>image-path("rails.png")</tt> becomes <tt>"/assets/rails.png"</tt>.</li>
</ul>
<p>The more generic form can also be used but the asset path and class must both be specified:</p>
<ul>
	<li><tt>asset-url("rails.png", image)</tt> becomes <tt>url(/assets/rails.png)</tt></li>
	<li><tt>asset-path("rails.png", image)</tt> becomes <tt>"/assets/rails.png"</tt></li>
</ul>
<h5 id="javascript-coffeescript-and-erb">2.2.3 JavaScript/CoffeeScript and <span class="caps">ERB</span></h5>
<p>If you add an <tt>erb</tt> extension to a JavaScript asset, making it something such as <tt>application.js.erb</tt>, then you can use the <tt>asset_path</tt> helper in your JavaScript code:</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
$('#logo').attr({
  src: &quot;&lt;%= asset_path('logo.png') %&gt;&quot;
});
</pre>
</div>
<p>This writes the path to the particular asset being referenced.</p>
<p>Similarly, you can use the <tt>asset_path</tt> helper in CoffeeScript files with <tt>erb</tt> extension (eg. <tt>application.js.coffee.erb</tt>):</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
$('#logo').attr src: &quot;&lt;%= asset_path('logo.png') %&gt;&quot;
</pre>
</div>
<h4 id="manifest-files-and-directives">2.3 Manifest Files and Directives</h4>
<p>Sprockets uses manifest files to determine which assets to include and serve. These manifest files contain <em>directives</em> &#8212; instructions that tell Sprockets which files to require in order to build a single <span class="caps">CSS</span> or JavaScript file. With these directives, Sprockets loads the files specified, processes them if necessary, concatenates them into one single file and then compresses them (if <tt>Rails.application.config.assets.compress</tt> is true). By serving one file rather than many, the load time of pages are greatly reduced as there are fewer requests to make.</p>
<p>For example, in the default Rails application there&#8217;s a <tt>app/assets/javascripts/application.js</tt> file which contains the following lines:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
// ...
//= require jquery
//= require jquery_ujs
//= require_tree .
</pre>
</div>
<p>In JavaScript files, the directives begin with <tt>//=</tt>. In this case, the file is using the <tt>require</tt> and the <tt>require_tree</tt> directives. The <tt>require</tt> directive is used to tell Sprockets the files that you wish to require. Here, you are requiring the files <tt>jquery.js</tt> and <tt>jquery_ujs.js</tt> that are available somewhere in the search path for Sprockets. You need not supply the extensions explicitly. Sprockets assumes you are requiring a <tt>.js</tt> file when done from within a <tt>.js</tt> file.</p>
<div class="note"><p>In Rails 3.1 the <tt>jquery-rails</tt> gem provides the <tt>jquery.js</tt> and <tt>jquery_ujs.js</tt> files via the asset pipeline. You won&#8217;t see them in the application tree.</p></div>
<p>The <tt>require_tree</tt> directive tells Sprockets to recursively include <em>all</em> JavaScript files in this directory into the output. Only a path relative to the manifest file can be specified. There is also a <tt>require_directory</tt> directive which includes all JavaScript files only in the directory specified (no nesting).</p>
<p>Directives are processed top to bottom, but the order in which files are included by <tt>require_tree</tt> is unspecified. You should not rely on any particular order among those. If you need to ensure some particular JavaScript ends up above some other, require it before in the manifest. Note that the family of <tt>require</tt> directives prevents files from being included twice in the output.</p>
<p>There&#8217;s also a default <tt>app/assets/stylesheets/application.css</tt> file which contains these lines:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
/* ...
*= require_self
*= require_tree .
*/
</pre>
</div>
<p>The directives that work in the JavaScript files also work in stylesheets, obviously including stylesheets rather than JavaScript files. The <tt>require_tree</tt> directive here works the same way as the JavaScript one, requiring all stylesheets from the current directory.</p>
<p>In this example <tt>require_self</tt> is used. This puts the <span class="caps">CSS</span> contained within the file (if any) at the precise location of the <tt>require_self</tt> call. If <tt>require_self</tt> is called more than once, only the last call is respected.</p>
<div class="note"><p>If you want to use multiple Sass files, use the <a href="http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#import">Sass <tt>@import</tt> rule</a> instead of the Sprockets directives. Using Sprockets directives all Sass files exist within their own scope, making variables or mixins only available within the document they were defined in.</p></div>
<p>You can have as many manifest files as you need. For example the <tt>admin.css</tt> and <tt>admin.js</tt> manifest could contain the JS and <span class="caps">CSS</span> files that are used for the admin section of an application.</p>
<p>The same remarks about ordering made above apply. In particular, you can specify individual files and they are compiled in the order specified:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
/* ...
*= require reset
*= require layout
*= require chrome
*/
</pre>
</div>
<h4 id="preprocessing">2.4 Preprocessing</h4>
<p>The file extensions used on an asset determine what preprocessing is applied. When a controller or a scaffold is generated with the default Rails gemset, a CoffeeScript file and a <span class="caps">SCSS</span> file are generated in place of a regular JavaScript and <span class="caps">CSS</span> file. The example used before was a controller called &#8220;projects&#8221;, which generated an <tt>app/assets/javascripts/projects.js.coffee</tt> and an <tt>app/assets/stylesheets/projects.css.scss</tt> file.</p>
<p>When these files are requested, they are processed by the processors provided by the <tt>coffee-script</tt> and <tt>sass-rails</tt> gems and then sent back to the browser as JavaScript and <span class="caps">CSS</span> respectively.</p>
<p>Additional layers of preprocessing can be requested by adding other extensions, where each extension is processed in a right-to-left manner. These should be used in the order the processing should be applied. For example, a stylesheet called <tt>app/assets/stylesheets/projects.css.scss.erb</tt> is first processed as <span class="caps">ERB</span>, then <span class="caps">SCSS</span> and finally served as <span class="caps">CSS</span>. The same applies to a JavaScript file &#8212; <tt>app/assets/javascripts/projects.js.coffee.erb</tt> is processed as <span class="caps">ERB</span>, CoffeeScript, and served as JavaScript.</p>
<p>Keep in mind that the order of these preprocessors is important. For example, if you called your JavaScript file <tt>app/assets/javascripts/projects.js.erb.coffee</tt> then it would be processed with the CoffeeScript interpreter first, which wouldn&#8217;t understand <span class="caps">ERB</span> and therefore you would run into problems.</p>
<h3 id="in-development">3 In Development</h3>
<p>In development mode assets are served as separate files in the order they are specified in the manifest file.</p>
<p>This manifest <tt>app/assets/javascripts/application.js</tt>:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
//= require core
//= require projects
//= require tickets
</pre>
</div>
<p>would generate this <span class="caps">HTML</span>:</p>
<div class="code_container">
<pre class="brush: xml; gutter: false; toolbar: false">
&lt;script src=&quot;/assets/core.js?body=1&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;/assets/projects.js?body=1&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;/assets/tickets.js?body=1&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
</pre>
</div>
<p>The <tt>body</tt> param is required by Sprockets.</p>
<h4 id="turning-debugging-off">3.1 Turning Debugging off</h4>
<p>You can turn off debug mode by updating <tt>config/environments/development.rb</tt> to include:</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
config.assets.debug = false
</pre>
</div>
<p>When debug mode is off Sprockets concatenates and runs the necessary preprocessors on all files. With debug mode turned off the manifest above would generate instead:</p>
<div class="code_container">
<pre class="brush: xml; gutter: false; toolbar: false">
&lt;script src=&quot;/assets/application.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
</pre>
</div>
<p>Assets are compiled and cached on the first request after the server is started. Sprockets sets a <tt>must-revalidate</tt> Cache-Control <span class="caps">HTTP</span> header to reduce request overhead on subsequent requests &#8212; on these the browser gets a 304 (Not Modified) response.</p>
<p>If any of the files in the manifest have changed between requests, the server responds with a new compiled file.</p>
<p>Debug mode can also be enabled in the Rails helper methods:</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
&lt;%= stylesheet_link_tag &quot;application&quot;, :debug =&gt; true %&gt;
&lt;%= javascript_include_tag &quot;application&quot;, :debug =&gt; true %&gt;
</pre>
</div>
<p>The <tt>:debug</tt> option is redundant if debug mode is on.</p>
<p>You could potentially also enable compression in development mode as a sanity check, and disable it on-demand as required for debugging.</p>
<h3 id="in-production">4 In Production</h3>
<p>In the production environment Rails uses the fingerprinting scheme outlined above. By default it is assumed that assets have been precompiled and will be served as static assets by your web server.</p>
<p>During the precompilation phase an MD5 is generated from the contents of the compiled files, and inserted into the filenames as they are written to disc. These fingerprinted names are used by the Rails helpers in place of the manifest name.</p>
<p>For example this:</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
&lt;%= javascript_include_tag &quot;application&quot; %&gt;
&lt;%= stylesheet_link_tag &quot;application&quot; %&gt;
</pre>
</div>
<p>generates something like this:</p>
<div class="code_container">
<pre class="brush: xml; gutter: false; toolbar: false">
&lt;script src=&quot;/assets/application-908e25f4bf641868d8683022a5b62f54.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
&lt;link href=&quot;/assets/application-4dd5b109ee3439da54f5bdfd78a80473.css&quot; media=&quot;screen&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;
</pre>
</div>
<p>The fingerprinting behavior is controlled by the setting of <tt>config.assets.digest</tt> setting in Rails (which is <tt>true</tt> for production, <tt>false</tt> for everything else).</p>
<div class="note"><p>Under normal circumstances the default option should not be changed. If there are no digests in the filenames, and far-future headers are set, remote clients will never know to refetch the files when their content changes.</p></div>
<h4 id="precompiling-assets">4.1 Precompiling Assets</h4>
<p>Rails comes bundled with a rake task to compile the asset manifests and other files in the pipeline to the disk.</p>
<p>Compiled assets are written to the location specified in <tt>config.assets.prefix</tt>. The default setting will use the <tt>public/assets</tt> directory.</p>
<p>You must use this task either during deployment or locally if you do not have write access to your production filesystem.</p>
<p>The rake task is:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
bundle exec rake assets:precompile
</pre>
</div>
<p>For faster asset precompiles, you can partially load your application by setting
<tt>config.assets.initialize_on_precompile</tt> to false in <tt>config/application.rb</tt>, though in that case templates
cannot see application objects or methods. <strong>Heroku requires this to be false.</strong></p>
<div class="warning"><p>If you set <tt>config.assets.initialize_on_precompile</tt> to false, be sure to
test <tt>rake assets:precompile</tt> locally before deploying. It may expose bugs where
your assets reference application objects or methods, since those are still
in scope in development mode regardless of the value of this flag.</p></div>
<p>Capistrano (v2.8.0 and above) has a recipe to handle this in deployment. Add the following line to <tt>Capfile</tt>:</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
load 'deploy/assets'
</pre>
</div>
<p>This links the folder specified in <tt>config.assets.prefix</tt> to <tt>shared/assets</tt>. If you already use this shared folder you&#8217;ll need to write your own deployment task.</p>
<p>It is important that this folder is shared between deployments so that remotely cached pages that reference the old compiled assets still work for the life of the cached page.</p>
<div class="note"><p>If you are precompiling your assets locally, you can use <tt>bundle install --without assets</tt> on the server to avoid installing the assets gems (the gems in the assets group in the Gemfile).</p></div>
<p>The default matcher for compiling files includes <tt>application.js</tt>, <tt>application.css</tt> and all files that do not end in <tt>js</tt> or <tt>css</tt>:</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
[ /\w+\.(?!js|css).+/, /application.(css|js)$/ ]
</pre>
</div>
<p>If you have other manifests or individual stylesheets and JavaScript files to include, you can add them to the <tt>precompile</tt> array:</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
config.assets.precompile += ['admin.js', 'admin.css', 'swfObject.js']
</pre>
</div>
<p>The rake task also generates a <tt>manifest.yml</tt> that contains a list with all your assets and their respective fingerprints. This is used by the Rails helper methods and avoids handing the mapping requests back to Sprockets. A typical manifest file looks like:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
---
rails.png: rails-bd9ad5a560b5a3a7be0808c5cd76a798.png
jquery-ui.min.js: jquery-ui-7e33882a28fc84ad0e0e47e46cbf901c.min.js
jquery.min.js: jquery-8a50feed8d29566738ad005e19fe1c2d.min.js
application.js: application-3fdab497b8fb70d20cfc5495239dfc29.js
application.css: application-8af74128f904600e41a6e39241464e03.css
</pre>
</div>
<p>The default location for the manifest is the root of the location specified in <tt>config.assets.prefix</tt> (&#8216;/assets&#8217; by default).</p>
<p>This can be changed with the <tt>config.assets.manifest</tt> option. A fully specified path is required:</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
config.assets.manifest = '/path/to/some/other/location'
</pre>
</div>
<div class="note"><p>If there are missing precompiled files in production you will get an <tt>Sprockets::Helpers::RailsHelper::AssetPaths::AssetNotPrecompiledError</tt> exception indicating the name of the missing file(s).</p></div>
<h5 id="server-configuration">4.1.1 Server Configuration</h5>
<p>Precompiled assets exist on the filesystem and are served directly by your webserver. They do not have far-future headers by default, so to get the benefit of fingerprinting you&#8217;ll have to update your server configuration to add them.</p>
<p>For Apache:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
&lt;LocationMatch &quot;^/assets/.*$&quot;&gt;
  # Some browsers still send conditional-GET requests if there's a
  # Last-Modified header or an ETag header even if they haven't
  # reached the expiry date sent in the Expires header.
  Header unset Last-Modified
  Header unset ETag
  FileETag None
  # RFC says only cache for 1 year
  ExpiresActive On
  ExpiresDefault &quot;access plus 1 year&quot;
&lt;/LocationMatch&gt;
</pre>
</div>
<p>For nginx:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
location ~ ^/assets/ {
  expires 1y;
  add_header Cache-Control public;

  # Some browsers still send conditional-GET requests if there's a
  # Last-Modified header or an ETag header even if they haven't
  # reached the expiry date sent in the Expires header.
  add_header Last-Modified &quot;&quot;;
  add_header ETag &quot;&quot;;
  break;
}
</pre>
</div>
<p>When files are precompiled, Sprockets also creates a <a href="http://en.wikipedia.org/wiki/Gzip">gzipped</a> (.gz) version of your assets. Web servers are typically configured to use a moderate compression ratio as a compromise, but since precompilation happens once Sprockets uses the maximum compression ratio, thus reducing the size of the data transfer to the minimum. On the other hand, web servers can be configured to serve compressed content directly from disk, rather than deflating non-compressed files themselves.</p>
<p>Nginx is able to do this automatically enabling <tt>gzip_static</tt>:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
location ~ ^/(assets)/  {
  root /path/to/public;
  gzip_static on; # to serve pre-gzipped version
  expires max;
  add_header Cache-Control public;
}
</pre>
</div>
<p>This directive is available if the core module that provides this feature was compiled with the web server. Ubuntu packages, even <tt>nginx-light</tt> have the module compiled. Otherwise, you may need to perform a manual compilation:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
./configure --with-http_gzip_static_module
</pre>
</div>
<p>If you&#8217;re compiling nginx with Phusion Passenger you&#8217;ll need to pass that option when prompted.</p>
<p>Unfortunately, a robust configuration for Apache is possible but tricky, please Google around.</p>
<h4 id="live-compilation">4.2 Live Compilation</h4>
<p>In some circumstances you may wish to use live compilation. In this mode all requests for assets in the pipeline are handled by Sprockets directly.</p>
<p>To enable this option set:</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
config.assets.compile = true
</pre>
</div>
<p>On the first request the assets are compiled and cached as outlined in development above, and the manifest names used in the helpers are altered to include the MD5 hash.</p>
<p>Sprockets also sets the <tt>Cache-Control</tt> <span class="caps">HTTP</span> header to <tt>max-age=31536000</tt>. This signals all caches between your server and the client browser that this content (the file served) can be cached for 1 year. The effect of this is to reduce the number of requests for this asset from your server; the asset has a good chance of being in the local browser cache or some intermediate cache.</p>
<p>This mode uses more memory, performs poorer than the default and is not recommended.</p>
<p>When deploying a production application to a system without any pre-existing JavaScript runtimes, you may want to add one to your Gemfile:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
group :production do
  gem 'therubyracer'
end
</pre>
</div>
<h3 id="customizing-the-pipeline">5 Customizing the Pipeline</h3>
<h4 id="css-compression">5.1 <span class="caps">CSS</span> Compression</h4>
<p>There is currently one option for compressing <span class="caps">CSS</span>, <span class="caps">YUI</span>. The <a href="http://developer.yahoo.com/yui/compressor/css.html"><span class="caps">YUI</span> <span class="caps">CSS</span> compressor</a> provides minification.</p>
<p>The following line enables <span class="caps">YUI</span> compression, and requires the <tt>yui-compressor</tt> gem.</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
config.assets.css_compressor = :yui
</pre>
</div>
<p>The <tt>config.assets.compress</tt> must be set to <tt>true</tt> to enable <span class="caps">CSS</span> compression.</p>
<h4 id="javascript-compression">5.2 JavaScript Compression</h4>
<p>Possible options for JavaScript compression are <tt>:closure</tt>, <tt>:uglifier</tt> and <tt>:yui</tt>. These require the use of the <tt>closure-compiler</tt>, <tt>uglifier</tt> or <tt>yui-compressor</tt> gems respectively.</p>
<p>The default Gemfile includes <a href="https://github.com/lautis/uglifier">uglifier</a>. This gem wraps <a href="https://github.com/mishoo/UglifyJS">UglifierJS</a> (written for NodeJS) in Ruby. It compresses your code by removing white space and other magical things like changing your <tt>if</tt> and <tt>else</tt> statements to ternary operators where possible.</p>
<p>The following line invokes <tt>uglifier</tt> for JavaScript compression.</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
config.assets.js_compressor = :uglifier
</pre>
</div>
<p>The <tt>config.assets.compress</tt> must be set to <tt>true</tt> to enable JavaScript compression</p>
<div class="note"><p>You will need a <a href="https://github.com/sstephenson/execjs#readme">ExecJS</a> supported runtime in order to use <tt>uglifier</tt>. If you are using Mac OS X or Windows you have installed a JavaScript runtime in your operating system. Check <a href="https://github.com/sstephenson/execjs#readme">ExecJS</a> documentation to know all supported JavaScript runtimes.</p></div>
<h4 id="using-your-own-compressor">5.3 Using Your Own Compressor</h4>
<p>The compressor config settings for <span class="caps">CSS</span> and JavaScript also take any Object. This object must have a <tt>compress</tt> method that takes a string as the sole argument and it must return a string.</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
class Transformer
  def compress(string)
    do_something_returning_a_string(string)
  end
end
</pre>
</div>
<p>To enable this, pass a <tt>new</tt> Object to the config option in <tt>application.rb</tt>:</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
config.assets.css_compressor = Transformer.new
</pre>
</div>
<h4 id="changing-the-_assets_-path">5.4 Changing the <em>assets</em> Path</h4>
<p>The public path that Sprockets uses by default is <tt>/assets</tt>.</p>
<p>This can be changed to something else:</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
config.assets.prefix = &quot;/some_other_path&quot;
</pre>
</div>
<p>This is a handy option if you have any existing project (pre Rails 3.1) that already uses this path or you wish to use this path for a new resource.</p>
<h4 id="x-sendfile-headers">5.5 X-Sendfile Headers</h4>
<p>The X-Sendfile header is a directive to the server to ignore the response from the application, and instead serve the file specified in the headers. This option is off by default, but can be enabled if your server supports it. When enabled, this passes responsibility for serving the file to the web server, which is faster.</p>
<p>Apache and nginx support this option which is enabled in <tt>config/environments/production.rb</tt>.</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
# config.action_dispatch.x_sendfile_header = &quot;X-Sendfile&quot; # for apache
# config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx
</pre>
</div>
<div class="warning"><p>If you are upgrading an existing application and intend to use this option, take care to paste this configuration option only into <tt>production.rb</tt> (and not <tt>application.rb</tt>) and any other environment you define with production behavior.</p></div>
<h3 id="how-caching-works">6 How Caching Works</h3>
<p>Sprockets uses the default Rails cache store to cache assets in development and production.</p>
<p><span class="caps">TODO</span>: Add more about changing the default store.</p>
<h3 id="adding-assets-to-your-gems">7 Adding Assets to Your Gems</h3>
<p>Assets can also come from external sources in the form of gems.</p>
<p>A good example of this is the <tt>jquery-rails</tt> gem which comes with Rails as the standard JavaScript library gem. This gem contains an engine class which inherits from <tt>Rails::Engine</tt>. By doing this, Rails is informed that the directory for this gem may contain assets and the <tt>app/assets</tt>, <tt>lib/assets</tt> and <tt>vendor/assets</tt> directories of this engine are added to the search path of Sprockets.</p>
<h3 id="making-your-library-or-gem-a-pre-processor">8 Making Your Library or Gem a Pre-Processor</h3>
<p><span class="caps">TODO</span>: Registering gems on <a href="https://github.com/rtomayko/tilt">Tilt</a> enabling Sprockets to find them.</p>
<h3 id="upgrading-from-old-versions-of-rails">9 Upgrading from Old Versions of Rails</h3>
<p>There are two issues when upgrading. The first is moving the files to the new locations. See the section above for guidance on the correct locations for different file types.</p>
<p>The second is updating the various environment files with the correct default options. The following changes reflect the defaults in version 3.1.0.</p>
<p>In <tt>application.rb</tt>:</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
# Enable the asset pipeline
config.assets.enabled = true

# Version of your assets, change this if you want to expire all your assets
config.assets.version = '1.0'

# Change the path that assets are served from
# config.assets.prefix = &quot;/assets&quot;
</pre>
</div>
<p>In <tt>development.rb</tt>:</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
# Do not compress assets
config.assets.compress = false

# Expands the lines which load the assets
config.assets.debug = true
</pre>
</div>
<p>And in <tt>production.rb</tt>:</p>
<div class="code_container">
<pre class="brush: ruby; html-script: true; gutter: false; toolbar: false">
# Compress JavaScripts and CSS
config.assets.compress = true

# Choose the compressors to use
# config.assets.js_compressor  = :uglifier
# config.assets.css_compressor = :yui

# Don't fallback to assets pipeline if a precompiled asset is missed
config.assets.compile = false

# Generate digests for assets URLs.
config.assets.digest = true

# Defaults to Rails.root.join(&quot;public/assets&quot;)
# config.assets.manifest = YOUR_PATH

# Precompile additional assets (application.js, application.css, and all non-JS/CSS are already added)
# config.assets.precompile += %w( search.js )
</pre>
</div>
<p>There are no changes to <tt>test.rb</tt>. The defaults in the test environment are: <tt>config.assets.compile</tt> is true and <tt>config.assets.compress</tt>, <tt>config.assets.debug</tt> and <tt>config.assets.digest</tt> are false.</p>
<p>The following should also be added to <tt>Gemfile</tt>:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   &quot;~&gt; 3.1.0&quot;
  gem 'coffee-rails', &quot;~&gt; 3.1.0&quot;
  gem 'uglifier'
end
</pre>
</div>
<p>If you use the <tt>assets</tt> group with Bundler, please make sure that your <tt>config/application.rb</tt> has the following Bundler require statement.</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
if defined?(Bundler)
  # If you precompile assets before deploying to production, use this line
  Bundler.require *Rails.groups(:assets =&gt; %w(development test))
  # If you want your assets lazily compiled in production, use this line
  # Bundler.require(:default, :assets, Rails.env)
end
</pre>
</div>
<p>Instead of the old Rails 3.0 one</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
# If you have a Gemfile, require the gems listed there, including any gems
# you've limited to :test, :development, or :production.
Bundler.require(:default, Rails.env) if defined?(Bundler)
</pre>
</div>

        <h3>Feedback</h3>
        <p>
          You're encouraged to help improve the quality of this guide.
        </p>
        <p>
          If you see any typos or factual errors you are confident to
          patch, please clone <a href="https://github.com/lifo/docrails">docrails</a>
          and push the change yourself. That branch of Rails has public write access.
          Commits are still reviewed, but that happens after you've submitted your
          contribution. <a href="https://github.com/lifo/docrails">docrails</a> is
          cross-merged with master periodically.
        </p>
        <p>
          You may also find incomplete content, or stuff that is not up to date.
          Please do add any missing documentation for master. Check the
          <a href="ruby_on_rails_guides_guidelines.html">Ruby on Rails Guides Guidelines</a>
          for style and conventions.
        </p>
        <p>
          If for whatever reason you spot something to fix but cannot patch it yourself, please
          <a href="https://github.com/rails/rails/issues">open an issue</a>.
        </p>
        <p>And last but not least, any kind of discussion regarding Ruby on Rails
          documentation is very welcome in the <a href="http://groups.google.com/group/rubyonrails-docs">rubyonrails-docs mailing list</a>.
        </p>
      </div>
    </div>
  </div>

  <hr class="hide" />
  <div id="footer">
    <div class="wrapper">
      <p>This work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-Share Alike 3.0</a> License</p>
      <p>"Rails", "Ruby on Rails", and the Rails logo are trademarks of David Heinemeier Hansson. All rights reserved.</p>
    </div>
  </div>

  <script type="text/javascript" src="javascripts/guides.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shCore.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shBrushRuby.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shBrushXml.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shBrushSql.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shBrushPlain.js"></script>
  <script type="text/javascript">
    SyntaxHighlighter.all()
  </script>
</body>
</html>
